# Text Style Transfer with Contrastive Transfer Pattern Mining

## 1. TST란?

- Text Style Transfer(TST)는 문장의 **스타일(감정, 공손함 등)**은 바꾸고 **의미는 유지**하는 자연어 생성 기술
- 응용 분야: 욕설 중화, 데이터 증강, 사람-컴퓨터 상호작용

## 2. 기존 방식과 한계

- 병렬 데이터 부족으로 대부분 비지도 학습 사용
- 기존 방식:
  1. 스타일 분리 방식: 의미와 스타일을 분리 후 스타일만 수정
  2. 스타일 임베딩 방식: 통합 표현에 스타일 임베딩을 추가
- **문장을 어떻게 바꾸는지(전이 방식)는 고려하지 않음**

## 3. 전이 패턴의 필요성

- 실제 TST에는 다양한 **전이 패턴(transfer pattern)**이 존재
  - 예: 감정 단어를 반의어로 바꾸거나 문장 극성을 전환
- 하지만 전이 패턴을 수작업으로 정리하거나 분류하기엔 비효율적

## 4. 제안 기법: CTPM

- CTPM(Contrastive Transfer Pattern Mining)은 전이 패턴을 **자동 탐지**하고, **대조 학습**으로 문장 표현을 정밀화함
- 기존 TST 모델에 **플러그앤플레이** 방식으로 적용 가능

## 5. 전체 구조

- 두 가지 핵심 모듈로 구성:
  1. **클러스터링 모듈**: 스타일 내부 전이 패턴 자동 탐색
  2. **대조 학습 모듈**: 탐색된 패턴을 바탕으로 문장 표현 정교화

## 6. 문제 정의

- 입력: 문장 x와 스타일 s
- 목표: 스타일 s를 바꾼 문장 x_s를 생성하면서 원래 의미 유지

## 7. Adaptive Clustering Module

- 문장들을 자동으로 여러 전이 패턴으로 **클러스터링**
- 군집 수는 데이터 구조에 맞게 자동 조절
- BERT를 사용해 문장을 벡터로 만들고, **신경망 기반 클러스터링**으로 전이 패턴 레이블 생성

## 8. Contrastive Learning Module

- 같은 전이 패턴 혹은 같은 스타일을 가진 문장끼리 가깝게  
  그렇지 않으면 멀게 만드는 방식으로 표현 학습
- 두 가지 대조 손실 적용:
  - Intra-style loss: 같은 스타일 내에서 다른 전이 패턴 구분
  - Inter-style loss: 서로 다른 스타일 구분

## 9. 학습 및 추론

- 1단계: 클러스터링 모듈로 전이 패턴 레이블 생성
- 2단계: 대조 손실과 기존 TST 손실을 합쳐 학습
- 학습 후 추론 단계에서는 클러스터링 모듈 사용 안 함

## 10. 적용 모델

- **RACoLN**: 의미와 스타일을 분리하는 구조
- **Style Transformer**: 통합된 표현을 스타일 임베딩으로 조절
- 제안 방식은 두 모델 모두에 적용되어 성능 향상 확인됨

## 11. 실험 결과

- 두 개의 대표 모델과 두 개의 벤치마크 데이터셋에서  
  → 제안 기법의 **효과성과 범용성** 검증 완료

## 12. 한계점

- **사전학습 언어모델 기반 TST**에는 아직 실험 안 됨
- **다중 스타일 속성 변환**이 가능한 데이터셋이 없어 그 확장성도 미검증
